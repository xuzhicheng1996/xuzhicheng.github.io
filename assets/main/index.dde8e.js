window.__require=function e(t,o,i){function n(a,s){if(!o[a]){if(!t[a]){var r=a.split("/");if(r=r[r.length-1],!t[r]){var h="function"==typeof __require&&__require;if(!s&&h)return h(r,!0);if(c)return c(r,!0);throw new Error("Cannot find module '"+a+"'")}a=r}var d=o[a]={exports:{}};t[a][0].call(d.exports,function(e){return n(t[a][1][e]||e)},d,d.exports,e,t,o,i)}return o[a].exports}for(var c="function"==typeof __require&&__require,a=0;a<i.length;a++)n(i[a]);return n}({BtnAudio:[function(e,t){"use strict";cc._RF.push(t,"a3614yU+vxKs7QAM6gvc3/2","BtnAudio"),cc.Class({extends:cc.Component,properties:{Audio:{default:null,type:cc.AudioClip}},playMp3:function(){}}),cc._RF.pop()},{}],Config:[function(e,t,o){"use strict";cc._RF.push(t,"b35e46X56JFDLgpM8QxzYgM","Config"),o.__esModule=!0,o.default=void 0,o.default={Drill:{score:500,speed:6},"Bone-0":{score:10,speed:5},"Bone-1":{score:10,speed:5},"Bone-2":{score:50,speed:3},"Bone-3":{score:10,speed:5},"Gold-0-0":{score:50,speed:6},"Gold-0-1":{score:100,speed:5},"Gold-0-2":{score:200,speed:3},"Gold-0-3":{score:300,speed:1},"Gold-1-0":{score:50,speed:6},"Gold-1-1":{score:100,speed:5},"Gold-1-2":{score:200,speed:3},"Gold-1-3":{score:300,speed:1},"Stone-0-0":{score:10,speed:3},"Stone-0-1":{score:30,speed:2},"Stone-0-2":{score:60,speed:1},"Stone-0-3":{score:100,speed:.8},"Stone-1-0":{score:10,speed:3},"Stone-1-1":{score:30,speed:2},"Stone-1-2":{score:60,speed:1},"Stone-1-3":{score:100,speed:.8}},t.exports=o.default,cc._RF.pop()},{}],Hook:[function(e,t){"use strict";cc._RF.push(t,"896bfTFm6FIO5iNupN74M8c","Hook"),cc.Class({extends:cc.Component,properties:{},start:function(){this.init()},init:function(){this.Canvas=cc.find("Canvas"),this.Main=this.Canvas.getComponent("Main"),this.Prefab=this.Main.Prefab,this.Item=cc.find("Canvas/Header/Miner/Hook/item"),this.onCollisionEnter=this.onCollisionEnterA},onCollisionEnterA:function(e){2!=this.Main.HookState&&(this.other=e,this.isWall=this.Wall(e),this.isWall?this.Main.PullBackHook():(this.Main.SetSpeed(e),cc.audioEngine.play(this.Main.CollisionAudio),this.other.node.y=-(this.Main.Hook.height+2),this.other.node.x=-this.Main.Hook.width/2,e.node.parent=this.Item,e.node.anchorY=1,this.Main.PullBackHook()))},MoveItemToHook:function(){this.isWall||(this.other.node.y=-(this.Main.Hook.height+2),this.other.node.x=-this.Main.Hook.width/2)},Wall:function(e){return"Wall"==e.node.group},update:function(){this.other&&this.other.node&&2==this.Main.HookState&&this.MoveItemToHook()}}),cc._RF.pop()},{}],IndexMain:[function(e,t){"use strict";cc._RF.push(t,"46088f+PFdImIKRq5WDOvy+","IndexMain"),cc.Class({extends:cc.Component,properties:{Lighting:{type:cc.Node,default:null},BGM:{default:null,url:cc.AudioClip}},onLoad:function(){var e=cc.sequence(cc.fadeTo(1,0),cc.fadeTo(1,255)).repeatForever();this.Lighting.runAction(e),cc.find("Canvas/BtnBackground/Start").on(cc.Node.EventType.TOUCH_END,this.StartGame.bind(this)),this.BGM_ID=cc.audioEngine.play(this.BGM),cc.director.preloadScene("Game")},StartGame:function(){cc.audioEngine.stop(this.BGM_ID),cc.sys.localStorage.removeItem("level"),cc.director.loadScene("Game")}}),cc._RF.pop()},{}],Main:[function(e,t){"use strict";cc._RF.push(t,"a7abbtxvtpLoq5yORxKD06b","Main");var o,i=(o=e("./Config"))&&o.__esModule?o:{default:o};cc.Class({extends:cc.Component,properties:{speed:{default:3,displayName:"\u94a9\u5b50\u901f\u5ea6"},rotateSpeed:{default:1,displayName:"\u94a9\u5b50\u65cb\u8f6c\u901f\u5ea6"},HookRange:{default:70,displayName:"\u94a9\u5b50\u65cb\u8f6c\u89d2\u5ea6\u8303\u56f4"},Prefabs:{default:[],type:cc.Prefab},InitTime:{default:10},CollisionAudio:{default:null,url:cc.AudioClip},AddScroeAudio:{default:null,url:cc.AudioClip},mask:cc.Prefab},onLoad:function(){this.init(),cc.director.preloadScene("Index")},init:function(){var e=this;this.Miner=cc.find("Canvas/Header/Miner"),this.MinerAnimation=this.Miner.getComponent(cc.Animation),this.Hook=cc.find("Canvas/Header/Miner/Hook"),this.HookHeight=this.Hook.height,this.HookState=0,this.Score=cc.find("Canvas/Header/Info/ScoreAndTarget/Score").getComponent(cc.Label),this.TargetScore=cc.find("Canvas/Header/Info/ScoreAndTarget/Target").getComponent(cc.Label),this.Time=cc.find("Canvas/Header/Info/CheckpointAndTime/Time").getComponent(cc.Label),this.Checkpoint=cc.find("Canvas/Header/Info/CheckpointAndTime/Checkpoint").getComponent(cc.Label),this.itemArea=cc.find("Canvas/ItemArea"),this.manager=cc.director.getCollisionManager(),this.manager.enabled=!0,this.Prefab={},this.Prefabs.forEach(function(t){e.Prefab[t._name]=t});var t=cc.find("Canvas/emitHookBtn"),o=cc.find("Canvas/Pause");t.on("touchstart",this.emitHookBtn,this),o.on("touchstart",this.ShowMask,this),this.ResetInfo(),this.StartTime(),this.SetLevel(),this.CreateTargetScor(),this.CreateItem()},HookRoTate:function(){this.HookState||(this.Hook.angle>=70?this.rotateSpeed=-this.rotateSpeed:this.Hook.angle<=-70&&(this.rotateSpeed=Math.abs(this.rotateSpeed)),this.Hook.angle+=this.rotateSpeed)},emitHookBtn:function(){this.HookState||(this.HookState=1)},emitHook:function(){switch(this.HookState){case 1:this.Hook.height+=this.speed;break;case 2:this.Hook.height<=this.HookHeight?(this.Hook.children[1].childrenCount&&this.Handle(this.Hook.children[1].children),this.StopHookMove()):this.Hook.height-=this.speed}},PullBackHook:function(){this.MinerAnimation.play("PullRope"),this.HookState=2},SetSpeed:function(e){i.default[e.node.name]=i.default[e.node.name]||{},this.speed=i.default[e.node.name].speed||3},ResetInfo:function(){this.victory=this.Score.string=this.Time.string=this.Checkpoint.string=this.TargetScore.string=0},StartTime:function(){var e=this;this.Time.string=this.InitTime,this.timer=setInterval(function(){e.InitTime--,e.Time.string=e.InitTime,e.InitTime<=0&&(clearInterval(e.timer),e.GameOver())},1e3)},SetLevel:function(){cc.sys.localStorage.getItem("level")||cc.sys.localStorage.setItem("level",1),this.Checkpoint.string="\u7b2c"+cc.sys.localStorage.getItem("level")+"\u5173"},CreateTargetScor:function(){var e=1e3+500*(cc.sys.localStorage.getItem("level")-1);this.TargetScore.string=e>5e3?5e3:e},CreateItem:function(){var e=this,t=(this.TargetScore.string,this.TargetScore.string,parseInt(20*Math.random()+10),this.sortItems());this.CreateCalc(t).forEach(function(t){var o=cc.instantiate(e.Prefab[t._name]),i=e.randomXY();o.parent=e.itemArea,o.setPosition(i)})},randomXY:function(){this.itemArea.y,this.itemArea.height;var e=(this.itemArea.width-30)/2*2*(Math.random()-.5),t=(this.itemArea.height-30)/2*2*(Math.random()-.5);return cc.Vec2(e,t)},sortItems:function(){var e=[];for(var t in i.default)i.default[t].name=t,e.push(i.default[t]);return e.sort(function(e,t){return e.score>t.score?1:-1}),e},CreateCalc:function(){var e=this,t=this.createRandm(2,4),o=this.createRandm(10,15),i=this.createRandm(1,3),n=this.createRandm(1,3),c=[];[{name:"s",num:t},{name:"g",num:o},{name:"b",num:i},{name:"d",num:n}].forEach(function(a){switch(a.name){case"s":c=[].concat(c,e.CreateItemType("Stone-",0,1,0,3,t));break;case"g":c=[].concat(c,e.CreateItemType("Gold-",0,1,0,3,o));break;case"b":c=[].concat(c,e.CreateItemType("Bone-",0,3,0,0,i));break;case"d":c=[].concat(c,e.CreateItemType("Drill",0,0,0,0,n))}});var a=cc.sys.localStorage.getItem("level")-1;return c=[].concat(c,this.CreateItemType("Drill",0,0,0,0,a))},CreateItemType:function(e,t,o,i,n,c){for(var a=[],s=0;s<c;s++){var r,h=this.createRandm(t,o),d=this.createRandm(i,n);r="Bone-"==e?e+h:"Drill"==e?e:e+h+"-"+d,a.push(this.Prefab[r])}return a},createRandm:function(e,t){var o=(t+=1)-e,i=Math.random()*o+e;return parseInt(i)},StopHookMove:function(){this.HookState=0,this.Hook.height=this.HookHeight,this.MinerAnimation.stop("PullRope"),this.speed=3},Handle:function(e){this.AddScore(e),this.RemoveItem(e)},RemoveItem:function(e){e.forEach(function(e){e.destroy()})},AddScore:function(e){if(e[0]){var t=i.default[e[0].name]||{};this.Score.string=parseInt(this.Score.string)+(t.score||0),cc.audioEngine.play(this.AddScroeAudio),parseInt(this.Score.string)>=parseInt(this.TargetScore.string)&&(cc.log("\u6ee1\u5206"),this.GameOver())}},_GamePauseAminationCallBack:function(){cc.game.pause()},ShowMask:function(){var e;e=1==this.victory?"\u4e0b\u4e00\u5173":2==this.victory?"\u9000\u51fa\u6e38\u620f":"\u7ee7\u7eed\u6e38\u620f";var t=cc.instantiate(this.mask);t.setPosition(0,0),t.parent=this.node,t.getChildByName("GameOverBtn").getChildByName("Label").getComponent(cc.Label).string=e;var o=cc.callFunc(this._GamePauseAminationCallBack,this),i=cc.sequence(cc.scaleTo(.2,1,1),o);t.runAction(i)},CloseMask:function(){cc.game.resume()},Reload:function(){cc.game.resume(),this.timer&&clearInterval(this.timer),cc.director.loadScene("Game")},Next:function(){switch(this.victory){case 0:this.CloseMask();break;case 1:var e=this.Checkpoint.string.match(/\d+/)[0];cc.sys.localStorage.setItem("level",parseInt(e)+1),this.Reload();break;case 2:this.ExitGame()}},ExitGame:function(){cc.game.resume(),cc.director.loadScene("Index")},GameOver:function(){var e;e=Number(this.Score.string)>=Number(this.TargetScore.string)?1:2,this.victory=e,this.ShowMask()},update:function(){this.emitHook(),this.HookRoTate()}}),cc._RF.pop()},{"./Config":"Config"}],PrefabBtn:[function(e,t){"use strict";cc._RF.push(t,"93388aHccFMXp+/vo0hItAZ","PrefabBtn"),cc.Class({extends:cc.Component,properties:{mask:cc.Node,btnLabel:cc.Node},CloseMask:function(){var e=this.btnLabel.getComponent(cc.Label).string;switch(console.log(e),e){case"\u7ee7\u7eed\u6e38\u620f":cc.game.resume(),this.mask.destroy();break;case"\u4e0b\u4e00\u5173":this.Checkpoint=cc.find("Canvas/Header/Info/CheckpointAndTime/Checkpoint").getComponent(cc.Label);var t=this.Checkpoint.string.match(/\d+/)[0];cc.sys.localStorage.setItem("level",parseInt(t)+1),this.Reload();break;case"\u9000\u51fa\u6e38\u620f":cc.game.resume(),cc.director.loadScene("Index")}},Reload:function(){cc.game.resume(),cc.director.loadScene("Game")}}),cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(e,t){"use strict";cc._RF.push(t,"83ec5etcB1Mh4VsPfGi70lG","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}]},{},["BtnAudio","Config","Hook","Main","PrefabBtn","IndexMain","use_v2.0.x_cc.Toggle_event"]);